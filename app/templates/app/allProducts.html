{% load staticfiles %}
<!DOCTYPE html>
<html class="no-js lt-ie9 lt-ie8 lt-ie7">
<html class="no-js lt-ie9 lt-ie8">
<html class="no-js lt-ie9">
<html class="no-js">
<head>

  {% include "app/html_templates/header/headerTemplate.html" %}

  {% comment %}
  {% load compile_static %}
  <link rel="stylesheet" href="{% static 'app/assets/sass/style.scss'|compile %}"/>
  {% endcomment %}

  <script>
    $(document).ready(function(){
      $('[data-show="tooltip"]').tooltip();
    });
  </script>

  <script>
    {% if product.provider.is_visible %}
    function provider() {
      location.href = "{%  url 'app:provider_profile' product.provider.providerprofile.url_name %}"
    }
    {% endif %}

    function start() {
      location.href = "/"
    }
  </script>

  <script>
    $.post( "/updatepagehistory", { lastpage: "{{request.META.HTTP_REFERER}}", csrfmiddlewaretoken: "{{ csrf_token }}"} );
  </script>

  <!--tags needed for angular material-->
  <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/angular_material/1.0.0/angular-material.min.css">
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-animate.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-aria.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-messages.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angular_material/1.0.0/angular-material.min.js"></script>

  <!--range slider css-->
  <style>
    .range-slider-container {
      position: relative;
      height: 100px;
    }

    .range-slider-container md-slider {
      margin: 0;
    }

    .range-track-line {
      position: absolute;
      height: 2px;
      top: 23px;
      background-color: rgb(255, 64, 129);
    }

    .range-slider-container md-slider.md-default-theme.md-min .md-thumb:after {
      background-color: rgb(255, 64, 129) !important;
    }

    .range-slider-left, .range-slider-right {
      position: absolute;
      top: 0px;
    }

    .range-slider-right {
      right: 0px;
    }

    .range-slider-left md-slider .md-thumb-container {
      transition: -webkit-transform 0s linear;
      transition: transform 0s linear;
    }

    .range-slider-left md-slider.md-default-theme .md-track.md-track-fill {
      background-color: rgba(188, 188, 188, 1) !important;
    }

    .range-slider-left md-slider.md-default-theme .md-track:not(.md-track-fill) {
      background-color: rgb(255, 64, 129) !important;
    }

    .range-slider-container md-slider .md-thumb-container {
      transition: -webkit-transform 0s linear;
      transition: transform 0s linear;
    }

    .range-slider-container md-slider .md-track-container {
      transition: -webkit-transform 0s linear;
      transition: transform 0s linear;
    }
  </style>
</head>

<body ng-app="allProductsApp">

{% include "app/html_templates/header/navbarHeader.html" with navInfo='product'%}

<section id="fh5co-page" data-section="home"
         style="background-image: url({% static 'app/assets/images/full_image_1.jpg' %});"
         data-stellar-background-ratio="0.5">
  <div class="container">
    <div class="text-wrap">
      <div class="text-inner">
        <div class="row">
          <div class="col-md-8">
            <h1 class="text-left">Filter-Seite</h1>
          </div>
          <div class="col-md-4">
            <div class="panel panel-default pull-right"
                 style="background-color: rgba(245, 245, 245, 0.6); max-width: 200px; max-height: 150px;">
              {% if product.provider.is_visible %}
              <div class="btn">
                {% else %}
                <div>
                  {% endif %}

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="slant"></div>
  </div>
</section>


<section id="fh5co-questions" data-section="intro">

  <!--section-header-->
  <div class="container">
    <div class="row" style="width:100%">
      <div class="col-md-12 section-heading text-center">
        <h2 class="to-animate">Filter</h2>
        <div class="row">
          <div class="col-md-8 col-md-offset-2 subtext to-animate">
            <h3>Wählen Sie nach welchen Attributen die Produkte gefiltert werden sollen.</h3>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--hersteller filter aus backend-->
  <div ng-controller="AppCtrl" class="md-padding" ng-cloak>
    <div class="container">
      <legend>Hersteller-Filter</legend>
        <div layout="row" layout-align="start center">
        {% for provider in provider_list %}
          <div flex>
            <md-checkbox class="md-primary">{{ provider.name }}</md-checkbox>
          </div>
          {% if forloop.counter|divisibleby:"3" %}
            </div>
            <div layout="row" layout-align="start center">
          {% endif %}
          {% if forloop.last %}
              </div>
          {% endif %}
        {% endfor %}
    </div>
  </div>

  <!--kategorie filter aus backend-->
  <div ng-controller="AppCtrl" class="md-padding" ng-cloak>
    <div class="container">
      <legend>Kategorie-Filter</legend>
      <div layout="row" layout-align="start center">
        {% for category in category_list %}
        <div flex>
          <md-checkbox class="md-primary">{{ category.name }}</md-checkbox>
        </div>
        {% if forloop.counter|divisibleby:"4" %}
      </div>
      <div layout="row" layout-align="start center">
        {% endif %}
        {% if forloop.last %}
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>

  <!--button um hidden section anzuzeigen-->
  <div class="row" layout-align="center center">
    <button type="button" class="btn btn-link">Weitere Filter anzeigen</button>
  </div>
</section>


<section id="fh5co-work" data-section="images">

  <!--section-header-->
  <div class="container">
    <div class="row" style="width:100%">
      <div class="col-md-12 section-heading text-center">
        <h2 class="to-animate">Weitere Filter (hidden-section)</h2>
        <div class="row">
          <div class="col-md-8 col-md-offset-2 subtext to-animate">
            <h3>Wählen Sie noch präzisere Filter-Attribute.</h3>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--preis-slider-->
  <div ng-controller="AppCtrl2" class="md-padding" ng-cloak>
    <legend>Preis-Filter</legend>
    <div class="container">
      <div ng-init="lower=1;upper=40;gap=1;">
        <md-content class="md-padding" style="background-color:transparent">
          <range-slider min="1" max="40" step="1" lower-value="lower" upper-value="upper" gap="gap"></range-slider>
          <div>
            {% verbatim %}
            <p>min: {{lower}}€</p>
            <p>max: {{upper}}€</p>
            {% endverbatim %}
          </div>
        </md-content>
      </div>
    </div>
  </div>

  <!--Produkttyp filter aus backend-->
  <div ng-controller="AppCtrl" class="md-padding" ng-cloak>
    <div class="container">
      <legend>Produkttyp-Filter</legend>
      <div layout="row" layout-align="start center">
        {% for type in producttype_list %}
        <div flex="33">
          <md-checkbox class="md-primary">{{ type }}</md-checkbox>
        </div>
        {% if forloop.counter|divisibleby:"3" %}
          </div>
          <div layout="row" layout-align="start center">
        {% endif %}
        {% if forloop.last %}
           </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>

  {% verbatim %}
  <!--filter-container for material-checkboxes-->
  <div ng-controller="AppCtrl" class="md-padding" ng-cloak>

    <!--szenario-filter-->
    <div class="container">
      <legend>Szenario-Filter</legend>
      <div layout="row" layout-align="space-around center">
        <div>
          <md-checkbox class="md-primary">Szenario 1</md-checkbox>
        </div>
        <div>
          <md-checkbox class="md-primary">Szenario 2</md-checkbox>
        </div>
        <div>
          <md-checkbox class="md-primary">Szenario 3</md-checkbox>
        </div>
        <div>
          <md-checkbox class="md-primary">Szenario 4</md-checkbox>
        </div>
      </div>
      <div layout="row" layout-align="space-around center">
        <div>
          <md-checkbox class="md-primary">Szenario 5</md-checkbox>
        </div>
        <div>
          <md-checkbox class="md-primary">Szenario 6</md-checkbox>
        </div>
        <div>
          <md-checkbox class="md-primary">Szenario 7</md-checkbox>
        </div>
        <div>
          <md-checkbox class="md-primary">Szenario 8</md-checkbox>
        </div>
      </div>
    </div>

  </div>
  {% endverbatim %}

  <!--button um hidden section auszublenden-->
  <div class="row" layout-align="center center">
    <button type="button" class="btn btn-link">Weitere Filter ausblenden</button>
  </div>
</section>

<section id="fh5co-testimonials" data-section="tecData">

  <!--section-header-->
  <div class="container">
    <div class="row" style="width:100%">
      <div class="col-md-12 section-heading text-center">
        <h2 class="to-animate">Produkt-Liste</h2>
        <div class="row">
          <div class="col-md-8 col-md-offset-2 subtext to-animate">
            <h3>Die Produkt-Liste wurde nach ihren Interessen gefiltert. Sie haben nun die Möglichkeit diese zu sortieren.</h3>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% verbatim %}
  <!--sorting-selectbox-->
  <div ng-controller="sorting" class="md-padding" ng-cloak>

    <div class="container">
      <div layout="row" layout-align="space-around center">

        <md-input-container>
          <label>Sortieren nach...</label>
          <md-select ng-model="sort">
            <md-option ng-repeat="sort in sorts" value="{{sort}}">{{sort}}</md-option>
          </md-select>
        </md-input-container>
      </div>
    </div>
  </div>
  {% endverbatim %}

  <!--product-list-->
  {% if all_products %}
  {% for product in all_products %}
  <div class="col-md-4 col-sm-6 col-xxs-12">
    <a href="{{ product.image1.url }}" class="fh5co-project-item image-popup to-animate">
      <img src="{{ product.image1.url }}" alt="Image" class="img-responsive">
    </a>
  </div>
  {% endfor %}
  {% endif %}
</section>

{% include "app/html_templates/sections/commentSection.html" %}

{% include "app/html_templates/footer/footerTemplate.html" %}

{% include "app/html_templates/modals/modals.html" %}


<!--script for range slider-->
{% verbatim %}
<script type="text/ng-template" id="range-slider.tpl.html">
  <div class='range-slider-container'>
    <div class='range-slider-left' ng-style="{width:lowerWidth+'%'}">
      <md-slider ng-model="lowerValue" min='{{min}}' max='{{lowerMaxLimit}}' step="{{step}}"
                 aria-label="lowerSlider"></md-slider>
    </div>
    <div class="range-track-line"
         ng-style="{width:tracker.width+'%',left:tracker.left+'%',right:tracker.right+'%'}"></div>
    <div class='range-slider-right' ng-style="{width:upperWidth+'%'}">
      <md-slider ng-model="upperValue" min="{{upperMinLimit}}" max="{{max}}" step="{{step}}"
                 aria-label="upperSlider"></md-slider>
    </div>
  </div>
</script>
{% endverbatim %}

<!--script for angular components-->
<script type="text/javascript">
  angular
    .module('allProductsApp', ['ngMaterial', "directives.rangeSlider"])
    .controller('sorting', function($scope) {
      $scope.sorts = [
        "Preis aufsteigend",
        "Preis absteigend",
        "Nach Hersteller",
        "Alphabetisch A-Z"
      ];
    })
    .controller('AppCtrl', function($scope) {
    })
    .controller('AppCtrl2', function($scope) {
      $scope.color = {
        blue: Math.floor(Math.random() * 255)
      };
    });

  //directive for range-slider
  angular.module('directives.rangeSlider', ['ngMaterial'])
    .directive('rangeSlider', function () {
      return {
        restrict   : "E",
        scope      : {
          max       : '=',
          min       : '=',
          gap       : '=?',
          step      : '=?',
          lowerValue: "=",
          upperValue: "="
        },
        templateUrl: 'range-slider.tpl.html',
        controller : ["$scope", function ($scope) {

          var COMFORTABLE_STEP = $scope.step, // whether the step is comfortable that depends on u
            tracker = $scope.tracker = {    // track style
              width: 0,
              left : 0,
              right: 0
            };

          function updateSliders() {

            if ($scope.upperValue - $scope.lowerValue > $scope.gap) {

              $scope.lowerMaxLimit = $scope.lowerValue + COMFORTABLE_STEP;
              $scope.upperMinLimit = $scope.upperValue - COMFORTABLE_STEP;

            } else {
              $scope.lowerMaxLimit = $scope.lowerValue;
              $scope.upperMinLimit = $scope.upperValue;
            }

            updateSlidersStyle();

          }

          function updateSlidersStyle() {
            // update sliders style
            $scope.lowerWidth = $scope.lowerMaxLimit / $scope.max * 100;
            $scope.upperWidth = ($scope.max - $scope.upperMinLimit) / $scope.max * 100;

            // update tracker line style
            tracker.width = 100 - $scope.lowerWidth - $scope.upperWidth;
            tracker.left = $scope.lowerWidth || 0;
            tracker.right = $scope.upperWidth || 0;
          }

          // watch lowerValue & upperValue to update sliders
          $scope.$watchGroup(["lowerValue", "upperValue"], function (newVal) {

            // filter the default initialization
            if (newVal !== undefined) {
              updateSliders();
            }

          });

          // init
          $scope.step = $scope.step || 1;
          $scope.gap = $scope.gap || 0;
          $scope.lowerMaxLimit = $scope.lowerValue + COMFORTABLE_STEP;
          $scope.upperMinLimit = $scope.upperValue - COMFORTABLE_STEP;
          updateSlidersStyle();
        }]
      };

    })
</script>
</body>
</html>